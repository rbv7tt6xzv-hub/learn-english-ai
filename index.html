<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Learn English AI ‚Äî Profesores</title>
  <style>
    body{
      margin:0; font-family: Arial, sans-serif; background:#0f172a; color:#fff;
      display:flex; justify-content:center; align-items:center; min-height:100vh; padding:18px;
    }
    .app{width:100%; max-width:520px; background:#111c33; border:1px solid #22304f; border-radius:16px; padding:18px;
      box-shadow:0 12px 30px rgba(0,0,0,.35);}
    h1{margin:0 0 6px 0; font-size:22px;}
    .sub{margin:0 0 12px 0; color:#a9b4cf; line-height:1.35;}
    .top{
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px; flex-wrap:wrap; margin:10px 0 12px;
    }
    .chip{
      display:inline-flex; gap:8px; align-items:center;
      background:#0b1220; border:1px solid #2b3a5a; color:#cbd5e1;
      padding:8px 10px; border-radius:999px; font-size:13px;
    }
    .stats{color:#cbd5e1; font-size:13px; line-height:1.35;}
    .card{
      background:#0b1220; border:1px solid #2b3a5a; border-radius:14px; padding:14px; margin-top:10px;
    }
    .story{color:#a9b4cf; margin:0 0 10px 0; line-height:1.35;}
    .titleRow{display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;}
    .lessonTitle{font-weight:800; margin:0; font-size:16px;}
    .mode{color:#94a3b8; font-size:12px; margin:2px 0 0 0;}
    .prompt{
      margin-top:12px; padding:12px; border-radius:12px;
      background:#111a2e; border:1px solid #25385e;
    }
    .label{color:#94a3b8; font-size:12px; margin:0 0 6px 0;}
    .es{font-size:18px; font-weight:800; margin:0;}
    .en{margin:8px 0 0 0; color:#e5e7eb; font-size:15px;}
    .meaning{margin:8px 0 0 0; color:#cbd5e1; font-size:14px; line-height:1.35;}
    .words{
      margin-top:10px; display:flex; flex-wrap:wrap; gap:8px;
    }
    .w{
      background:#0b1220; border:1px solid #2b3a5a; border-radius:999px;
      padding:6px 10px; font-size:12px; color:#dbeafe;
    }
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
    button{
      flex:1; min-width:160px;
      padding:12px 12px; border-radius:12px; border:none;
      background:#22c55e; color:#04130a; font-weight:800; font-size:14px;
    }
    button.secondary{background:#334155; color:#e2e8f0;}
    button.danger{background:#ef4444; color:#fff;}
    input{
      width:100%; margin-top:12px; padding:12px; border-radius:12px;
      border:1px solid #2b3a5a; background:#0b1220; color:#fff; font-size:16px; outline:none;
    }
    .choices{margin-top:10px; display:flex; flex-direction:column; gap:10px;}
    .choice{
      text-align:left; padding:12px; border-radius:12px;
      border:1px solid #2b3a5a; background:#0b1220; color:#e2e8f0; font-weight:700;
    }
    .choice:hover{filter:brightness(1.07);}
    .bank{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;}
    .token{
      padding:8px 10px; border-radius:999px; border:1px solid #2b3a5a;
      background:#0b1220; color:#fff; font-weight:700; font-size:13px;
    }
    .built{
      margin-top:10px; padding:10px; border-radius:12px; border:1px dashed #2b3a5a;
      min-height:44px; color:#cbd5e1;
    }
    .feedback{margin-top:12px; font-weight:800; line-height:1.35;}
    .small{color:#a9b4cf; font-size:12px; margin-top:6px; line-height:1.35;}
    .hr{height:1px; background:#22304f; margin:14px 0;}
  </style>
</head>
<body>
  <div class="app">
    <h1>Learn English AI üá∫üá∏</h1>
    <p class="sub">Profesores con voz + significado en espa√±ol + ejercicios reales (sin backend).</p>

    <div class="top">
      <div class="chip" id="teacherChip">üßë‚Äçüè´ Teacher</div>
      <div class="stats">
        <div id="progressTxt">Lecci√≥n 1/1</div>
        <div id="scoreTxt">Puntos: 0 | Nivel: 1</div>
      </div>
    </div>

    <div class="card">
      <div class="titleRow">
        <div>
          <p class="lessonTitle" id="lessonTitle">Cargando‚Ä¶</p>
          <p class="mode" id="modeTxt">Modo</p>
        </div>
        <div class="chip" id="goalChip">üéØ Meta</div>
      </div>

      <p class="story" id="storyTxt">‚Ä¶</p>

      <div class="prompt">
        <p class="label">Espa√±ol (lo que quieres decir):</p>
        <p class="es" id="spanishTxt">‚Ä¶</p>

        <p class="label" style="margin-top:10px;">Ingl√©s (frase correcta):</p>
        <p class="en" id="englishTxt">‚Ä¶</p>

        <p class="label" style="margin-top:10px;">Significado / explicaci√≥n en espa√±ol:</p>
        <p class="meaning" id="meaningTxt">‚Ä¶</p>

        <div class="words" id="wordsBox"></div>
      </div>

      <!-- area din√°mica por tipo de ejercicio -->
      <div id="exerciseArea"></div>

      <div class="row">
        <button onclick="speak()">üîä Escuchar (profesor)</button>
        <button class="secondary" onclick="showHint()">üí° Pista</button>
      </div>

      <div class="row">
        <button onclick="check()">‚úÖ Revisar</button>
        <button class="secondary" onclick="next()">‚û°Ô∏è Siguiente</button>
      </div>

      <div class="feedback" id="feedback"></div>
      <div class="small" id="hintLine"></div>

      <div class="hr"></div>

      <div class="row">
        <button class="secondary" onclick="resetProgress()">üîÅ Reiniciar</button>
        <button class="danger" onclick="mute()">üîá Parar voz</button>
      </div>

      <div class="small">
        Nota iPhone: sube volumen y quita silencio. La voz solo funciona despu√©s de tocar un bot√≥n.
      </div>
    </div>
  </div>

<script>
  // ‚úÖ Lecciones con: frase EN, espa√±ol, significado, vocabulario, y tipo de ejercicio
  const lessons = [
    {
      title: "Supervivencia: Conocer a alguien",
      teacher: { name:"Teacher Anna", emoji:"üë©‚Äçüè´", lang:"en-US", pitch:1.15, rate:0.95 },
      story: "Llegas a EE.UU. y alguien te sonr√≠e. Te hace una pregunta s√∫per com√∫n.",
      goal: "Presentarte y responder",
      es: "¬øDe d√≥nde eres?",
      en: "Where are you from?",
      meaning: "Se usa para preguntar tu pa√≠s o ciudad. Literal: ‚Äú¬øDe d√≥nde vienes?‚Äù",
      vocab: [
        ["Where", "d√≥nde"],
        ["are", "eres/est√°s"],
        ["you", "t√∫/usted"],
        ["from", "de (origen)"]
      ],
      type: "LISTEN_TYPE",
      hint: "Empieza con ‚ÄúWhere‚Ä¶‚Äù y termina con ‚Äúfrom‚Äù."
    },
    {
      title: "Caf√©: ordenar algo",
      teacher: { name:"Teacher Mike", emoji:"üë®‚Äçüè´", lang:"en-US", pitch:0.92, rate:0.95 },
      story: "Entras a una cafeter√≠a. El barista te pregunta qu√© quieres tomar.",
      goal: "Pedir bebidas",
      es: "¬øQu√© deseas tomar?",
      en: "What would you like to drink?",
      meaning: "Forma educada para pedir algo. Muy com√∫n en tiendas/restaurantes.",
      vocab: [
        ["What", "qu√©"],
        ["would", "auxiliar (cortes√≠a)"],
        ["you", "t√∫/usted"],
        ["like", "gustar√≠a"],
        ["to drink", "beber / tomar"]
      ],
      type: "MULTIPLE_CHOICE",
      choices: [
        "What do you drink?",
        "What would you like to drink?",
        "Where do you like drink?"
      ],
      answerIndex: 1,
      hint: "La frase educada casi siempre usa ‚Äúwould you like‚Ä¶‚Äù."
    },
    {
      title: "Amigos: tu nombre",
      teacher: { name:"Teacher Alex", emoji:"üßë‚Äçüè´", lang:"en-US", pitch:1.02, rate:1.0 },
      story: "Conoces a alguien. Quiere saber tu nombre.",
      goal: "Presentarte",
      es: "¬øC√≥mo te llamas?",
      en: "What's your name?",
      meaning: "Contracci√≥n: What‚Äôs = What is. Frase b√°sica y natural.",
      vocab: [
        ["What's", "qu√© es / cu√°l es"],
        ["your", "tu"],
        ["name", "nombre"]
      ],
      type: "ORDER_WORDS",
      bank: ["name?", "your", "What's"],
      hint: "Empieza con What‚Äôs y termina con name?"
    },
    {
      title: "Mini conversaci√≥n: responder r√°pido",
      teacher: { name:"Teacher Anna", emoji:"üë©‚Äçüè´", lang:"en-US", pitch:1.15, rate:0.98 },
      story: "Alguien te dice: ‚ÄúNice to meet you!‚Äù T√∫ respondes de forma natural.",
      goal: "Responder en conversaci√≥n",
      es: "Igualmente / Mucho gusto",
      en: "Nice to meet you too!",
      meaning: "‚ÄòToo‚Äô significa ‚Äòtambi√©n‚Äô. Es respuesta normal cuando alguien dice ‚ÄòNice to meet you‚Äô.",
      vocab: [
        ["Nice", "agradable / gusto"],
        ["to meet", "conocer"],
        ["you", "t√∫/usted"],
        ["too", "tambi√©n"]
      ],
      type: "CHAT_REPLY",
      choices: [
        "Nice meet you.",
        "Nice to meet you too!",
        "Where are you too?"
      ],
      answerIndex: 1,
      hint: "La respuesta correcta incluye ‚Äútoo‚Äù (tambi√©n)."
    }
  ];

  let idx = 0;
  let score = 0;
  let level = 1;
  let hintShown = false;

  function byId(id){ return document.getElementById(id); }
  function normalize(s){
    return (s||"").toLowerCase().trim().replace(/[‚Äô]/g,"'").replace(/\s+/g," ");
  }

  function render(){
    const L = lessons[idx];
    hintShown = false;
    byId("feedback").innerText = "";
    byId("hintLine").innerText = "";

    byId("teacherChip").innerText = `${L.teacher.emoji} ${L.teacher.name}`;
    byId("progressTxt").innerText = `Lecci√≥n ${idx+1}/${lessons.length}`;
    byId("scoreTxt").innerText = `Puntos: ${score} | Nivel: ${level}`;

    byId("lessonTitle").innerText = L.title;
    byId("modeTxt").innerText = `Modo: ${modeLabel(L.type)}`;
    byId("goalChip").innerText = `üéØ ${L.goal}`;
    byId("storyTxt").innerText = L.story;

    byId("spanishTxt").innerText = L.es;
    byId("englishTxt").innerText = L.en;
    byId("meaningTxt").innerText = L.meaning;

    const wordsBox = byId("wordsBox");
    wordsBox.innerHTML = "";
    L.vocab.forEach(([w, m])=>{
      const el = document.createElement("span");
      el.className = "w";
      el.textContent = `${w} = ${m}`;
      wordsBox.appendChild(el);
    });

    renderExercise(L);
  }

  function modeLabel(type){
    if(type==="LISTEN_TYPE") return "Escucha y escribe";
    if(type==="MULTIPLE_CHOICE") return "Opci√≥n m√∫ltiple";
    if(type==="ORDER_WORDS") return "Ordena palabras";
    if(type==="CHAT_REPLY") return "Elige respuesta";
    return "Ejercicio";
  }

  function renderExercise(L){
    const area = byId("exerciseArea");
    area.innerHTML = "";

    if(L.type === "LISTEN_TYPE"){
      const input = document.createElement("input");
      input.id = "userInput";
      input.placeholder = "Escribe la frase en ingl√©s aqu√≠‚Ä¶";
      area.appendChild(input);
      return;
    }

    if(L.type === "MULTIPLE_CHOICE" || L.type === "CHAT_REPLY"){
      const wrap = document.createElement("div");
      wrap.className = "choices";

      L.choices.forEach((c, i)=>{
        const btn = document.createElement("button");
        btn.className = "choice";
        btn.type = "button";
        btn.textContent = c;
        btn.onclick = ()=> {
          // guarda selecci√≥n
          byId("feedback").innerText = `Seleccionaste: "${c}"`;
          area.dataset.selected = String(i);
        };
        wrap.appendChild(btn);
      });

      area.appendChild(wrap);
      area.dataset.selected = "";
      return;
    }

    if(L.type === "ORDER_WORDS"){
      const label = document.createElement("p");
      label.className = "small";
      label.innerText = "Toca las palabras en orden para construir la frase:";
      area.appendChild(label);

      const bank = document.createElement("div");
      bank.className = "bank";
      bank.id = "bank";

      const built = document.createElement("div");
      built.className = "built";
      built.id = "built";
      built.innerText = "Tu frase: ";

      const chosen = [];

      L.bank.forEach(tok=>{
        const t = document.createElement("button");
        t.className = "token";
        t.type = "button";
        t.textContent = tok;
        t.onclick = ()=>{
          chosen.push(tok);
          built.innerText = "Tu frase: " + chosen.join(" ");
          t.disabled = true;
        };
        bank.appendChild(t);
      });

      const resetBtn = document.createElement("button");
      resetBtn.className = "secondary";
      resetBtn.type = "button";
      resetBtn.style.marginTop = "10px";
      resetBtn.innerText = "‚Ü©Ô∏è Rehacer orden";
      resetBtn.onclick = ()=> render(); // re-render current

      area.appendChild(bank);
      area.appendChild(built);
      area.appendChild(resetBtn);
      return;
    }
  }

  function speak(){
    const L = lessons[idx];
    const u = new SpeechSynthesisUtterance(L.en);
    u.lang = L.teacher.lang;
    u.pitch = L.teacher.pitch;
    u.rate = L.teacher.rate;
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }

  function mute(){
    speechSynthesis.cancel();
    byId("feedback").innerText = "üîá Voz detenida.";
  }

  function showHint(){
    const L = lessons[idx];
    hintShown = true;
    byId("hintLine").innerText = "üí° Pista: " + L.hint;
  }

  function check(){
    const L = lessons[idx];

    // Reglas de validaci√≥n por tipo:
    if(L.type === "LISTEN_TYPE"){
      const val = normalize(byId("userInput").value);
      const correct = normalize(L.en);
      if(!val){
        byId("feedback").innerText = "Escribe algo primero üôÇ";
        return;
      }
      if(val === correct){
        win("‚úÖ Perfecto. Suena natural.");
      } else {
        byId("feedback").innerText = "‚ùå Casi. Toca üîä y copia la frase exacta (tiene que ser igual).";
      }
      return;
    }

    if(L.type === "MULTIPLE_CHOICE" || L.type === "CHAT_REPLY"){
      const selected = byId("exerciseArea").dataset.selected;
      if(selected === ""){
        byId("feedback").innerText = "Elige una opci√≥n primero üôÇ";
        return;
      }
      if(Number(selected) === L.answerIndex){
        win("‚úÖ Correcto. As√≠ responden los americanos.");
      } else {
        byId("feedback").innerText = "‚ùå Incorrecto. Usa la opci√≥n que suena natural (con gram√°tica completa).";
        if(hintShown) byId("feedback").innerText += " (Mira la pista arriba)";
      }
      return;
    }

    if(L.type === "ORDER_WORDS"){
      const built = byId("built").innerText.replace("Tu frase:","").trim();
      const val = normalize(built);
      const correct = normalize(L.en);
      if(!val){
        byId("feedback").innerText = "Toca las palabras para formar la frase üôÇ";
        return;
      }
      if(val === correct){
        win("‚úÖ Excelente. Orden perfecto.");
      } else {
        byId("feedback").innerText = "‚ùå El orden no est√° bien. Dale a ‚ÄúRehacer orden‚Äù y prueba otra vez.";
      }
      return;
    }
  }

  function win(msg){
    score += hintShown ? 5 : 10;
    // nivel cada 30 puntos
    level = 1 + Math.floor(score / 30);
    byId("scoreTxt").innerText = `Puntos: ${score} | Nivel: ${level}`;
    byId("feedback").innerText = msg + ` (+${hintShown?5:10} puntos)`;
  }

  function next(){
    if(idx < lessons.length - 1){
      idx++;
      render();
    } else {
      byId("lessonTitle").innerText = "üéâ Demo completada";
      byId("modeTxt").innerText = "Siguiente: agregar 20 lecciones";
      byId("storyTxt").innerText = "Ya tienes profesores con voz, significado en espa√±ol y 4 tipos de ejercicios. Esto s√≠ es una base real.";
      byId("exerciseArea").innerHTML = "";
      byId("feedback").innerText = `Final: ${score} puntos | Nivel ${level}`;
      byId("hintLine").innerText = "Si quieres, te preparo 20 lecciones m√°s con el mismo formato.";
    }
  }

  function resetProgress(){
    idx = 0; score = 0; level = 1;
    render();
  }

  render();
</script>
</body>
</html>
